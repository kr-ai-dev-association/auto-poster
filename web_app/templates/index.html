<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto Poster</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        [x-cloak] { display: none !important; }
        .sidebar-item-active { @apply bg-gray-800 text-white; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen p-0 m-0">

    <div x-data="app()" class="min-h-screen flex bg-white">
        
        <!-- Left Sidebar -->
        <div class="w-64 bg-gray-900 text-white flex flex-col shadow-xl">
            <div class="p-6">
                <h1 class="text-2xl font-bold tracking-tight">ğŸš€ Auto Poster</h1>
                <p class="text-gray-400 text-xs mt-1">Multi-Platform Auto Posting</p>
            </div>
            
            <nav class="flex-grow mt-6 px-4 space-y-2">
                <button 
                    @click="mainTab = 'wiki'" 
                    :class="mainTab === 'wiki' ? 'bg-gray-800 text-white' : 'text-gray-300 hover:bg-gray-800 hover:text-white'"
                    class="w-full flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-all group"
                >
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10l4 4v10a2 2 0 01-2 2zM12 14v4M12 14a2 2 0 110-4 2 2 0 010 4z"/></svg>
                    Wiki Auto Poster
                </button>
                <button 
                    @click="mainTab = 'youtube'" 
                    :class="mainTab === 'youtube' ? 'bg-gray-800 text-white' : 'text-gray-300 hover:bg-gray-800 hover:text-white'"
                    class="w-full flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-all group"
                >
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
                    Youtube Poster
                </button>
                
                <!-- Admin Menu (Conditional) -->
                <template x-if="user?.is_super_admin">
                    <a 
                        href="/admin/users"
                        class="w-full flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-all group text-indigo-300 hover:bg-indigo-900 hover:text-white mt-4 border border-indigo-900"
                    >
                        <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
                        íšŒì› ê´€ë¦¬ (Admin)
                    </a>
                </template>
            </nav>

            <!-- User Info & Logout -->
            <div class="p-4 border-t border-gray-800 bg-gray-950">
                <div class="flex items-center mb-3">
                    <div class="w-8 h-8 rounded-full bg-indigo-600 flex items-center justify-center text-xs font-bold text-white mr-3" x-text="user?.name?.charAt(0)"></div>
                    <div class="flex-grow min-w-0">
                        <p class="text-xs font-bold text-white truncate" x-text="user?.name"></p>
                        <p class="text-[10px] text-gray-500 truncate" x-text="user?.email"></p>
                    </div>
                </div>
                <button @click="logout()" class="w-full py-2 text-xs font-bold text-gray-400 hover:text-white hover:bg-gray-800 rounded transition flex items-center justify-center">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/></svg>
                    ë¡œê·¸ì•„ì›ƒ
                </button>
            </div>

            <div class="p-4 border-t border-gray-800 text-xs text-gray-400 text-center">
                &copy; 2026 Banya AI
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="flex-grow flex flex-col min-h-0 overflow-hidden">
            
            <!-- Wiki Auto Poster Section -->
            <div x-show="mainTab === 'wiki'" class="flex flex-col h-full">
                <!-- Header -->
                <div class="bg-indigo-600 p-6 text-white shadow-md">
                    <div class="container mx-auto">
                        <h2 class="text-2xl font-bold">ğŸ“„ Wiki Auto Poster</h2>
                        <p class="text-indigo-100 text-sm mt-1">AI ê¸°ë°˜ ë§ˆí¬ë‹¤ìš´ ë³€í™˜ ë° ìë™ ë°°í¬ ì‹œìŠ¤í…œ</p>
                    </div>
                </div>

                <!-- Main Content (Full Width) -->
                <div class="flex-grow flex flex-col min-h-0 overflow-y-auto">
                    <!-- Tabs -->
                    <div class="bg-white border-b sticky top-0 z-10">
                        <div class="container mx-auto flex">
                            <button @click="tab = 'file'" :class="{'border-indigo-600 text-indigo-600': tab === 'file', 'border-transparent text-gray-500 hover:text-gray-700': tab !== 'file'}" class="flex-1 py-4 px-1 text-center border-b-2 font-medium text-sm focus:outline-none transition-colors">
                                ğŸ“‚ íŒŒì¼ ì—…ë¡œë“œ
                            </button>
                            <button @click="tab = 'text'" :class="{'border-indigo-600 text-indigo-600': tab === 'text', 'border-transparent text-gray-500 hover:text-gray-700': tab !== 'text'}" class="flex-1 py-4 px-1 text-center border-b-2 font-medium text-sm focus:outline-none transition-colors">
                                âœï¸ ì§ì ‘ ì‘ì„±
                            </button>
                        </div>
                    </div>

                    <div class="container mx-auto p-6 flex-grow flex flex-col min-h-0">
                        <!-- File Upload Tab -->
                        <div x-show="tab === 'file'" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0 translate-y-2" x-transition:enter-end="opacity-100 translate-y-0" class="flex-grow flex flex-col min-h-0">
                            <div 
                                @dragover.prevent="dragOver = true"
                                @dragleave.prevent="dragOver = false"
                                @drop.prevent="handleDrop($event)"
                                :class="{'border-indigo-500 bg-indigo-50': dragOver, 'border-gray-300 bg-gray-50': !dragOver}"
                                class="border-2 border-dashed rounded-lg p-10 text-center cursor-pointer transition-colors flex-grow flex flex-col justify-center items-center min-h-[400px]"
                                @click="$refs.fileInput.click()"
                            >
                                <input type="file" x-ref="fileInput" class="hidden" @change="handleFile($event)" accept=".md">
                                
                                <template x-if="!file">
                                    <div class="space-y-4">
                                        <svg class="mx-auto h-20 w-20 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48"><path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></svg>
                                        <div class="text-xl text-gray-600">
                                            <span class="font-medium text-indigo-600 hover:text-indigo-500">íŒŒì¼ ì„ íƒ</span>
                                            ë˜ëŠ” ì—¬ê¸°ì— ë“œë˜ê·¸í•˜ì„¸ìš”
                                        </div>
                                        <p class="text-sm text-gray-500">MD íŒŒì¼ë§Œ ì§€ì›ë©ë‹ˆë‹¤</p>
                                    </div>
                                </template>

                                <template x-if="file">
                                    <div class="space-y-4">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-20 w-20 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                                        <p class="text-lg font-medium text-gray-900" x-text="file.name"></p>
                                        <p class="text-sm text-gray-500" x-text="formatBytes(file.size)"></p>
                                        <button @click.stop="file = null" class="text-sm text-red-500 hover:text-red-700 underline">ì œê±°</button>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <!-- Text Input Tab -->
                        <div x-show="tab === 'text'" x-cloak x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0 translate-y-2" x-transition:enter-end="opacity-100 translate-y-0" class="flex-grow flex flex-col min-h-0">
                            <div class="space-y-4 flex-grow flex flex-col min-h-0">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ì œëª©</label>
                                    <input type="text" x-model="title" class="w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 text-lg" placeholder="ì˜ˆ: 2025 AI íŠ¸ë Œë“œ ì „ë§">
                                </div>
                                <div class="flex-grow flex flex-col min-h-0">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ë‚´ìš© (Markdown)</label>
                                    <textarea x-model="content" class="w-full flex-grow px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 font-mono text-base resize-none min-h-[500px]" placeholder="# ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Action Button & Result Area -->
                        <div class="mt-6 space-y-6 pb-10">
                            <button 
                                @click="upload()" 
                                :disabled="loading || (tab === 'file' && !file) || (tab === 'text' && (!title || !content))"
                                :class="{'opacity-50 cursor-not-allowed': loading || (tab === 'file' && !file) || (tab === 'text' && (!title || !content))}"
                                class="w-full flex justify-center py-4 px-6 border border-transparent rounded-lg shadow-lg text-lg font-bold text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all"
                            >
                                <span x-show="!loading">ğŸš€ ë³€í™˜ ë° ë°°í¬ ì‹œì‘</span>
                                <span x-show="loading" class="flex items-center">
                                    <svg class="animate-spin -ml-1 mr-3 h-6 w-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                                    ì²˜ë¦¬ ì¤‘... (ì•½ 1-2ë¶„ ì†Œìš”)
                                </span>
                            </button>

                            <!-- Result Area -->
                            <div x-show="result" x-cloak class="p-6 rounded-lg shadow-sm border" :class="result?.status === 'success' ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200'">
                                <div class="flex">
                                    <div class="flex-shrink-0">
                                        <template x-if="result?.status === 'success'">
                                            <svg class="h-8 w-8 text-green-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>
                                        </template>
                                        <template x-if="result?.status !== 'success'">
                                            <svg class="h-8 w-8 text-red-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" /></svg>
                                        </template>
                                    </div>
                                    <div class="ml-4 flex-grow">
                                        <h3 class="text-xl font-bold" :class="result?.status === 'success' ? 'text-green-800' : 'text-red-800'" x-text="result?.status === 'success' ? 'ë°°í¬ ì™„ë£Œ!' : 'ì˜¤ë¥˜ ë°œìƒ'"></h3>
                                        <div class="mt-3 text-lg" :class="result?.status === 'success' ? 'text-green-700' : 'text-red-700'">
                                            <template x-if="result?.status === 'success'">
                                                <div class="space-y-4">
                                                    <p>ì„±ê³µì ìœ¼ë¡œ ë³€í™˜ ë° ë°°í¬ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                                                    <div class="flex items-center gap-4">
                                                        <a :href="result.link" target="_blank" class="px-6 py-2 bg-green-600 text-white rounded-md font-bold hover:bg-green-700 transition shadow-md">ğŸ‘‰ ë¦¬í¬íŠ¸ ë³´ëŸ¬ê°€ê¸°</a>
                                                    </div>
                                                    
                                                    <!-- LinkedIn ê³µìœ  ì„¹ì…˜ -->
                                                    <div class="mt-6 pt-6 border-t border-green-200">
                                                        <h4 class="text-lg font-bold text-green-900 mb-4">ğŸ‘ï¸ ë¯¸ë¦¬ë³´ê¸°</h4>
                                                        <div class="flex flex-wrap gap-4 mb-6">
                                                            <button 
                                                                @click="previewHtml('ko')"
                                                                class="flex items-center px-6 py-3 bg-indigo-600 text-white font-bold rounded-md hover:bg-indigo-700 transition shadow-md"
                                                            >
                                                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                                                                í•œêµ­ì–´ ë¯¸ë¦¬ë³´ê¸°
                                                            </button>
                                                            <button 
                                                                @click="previewHtml('en')"
                                                                class="flex items-center px-6 py-3 bg-indigo-600 text-white font-bold rounded-md hover:bg-indigo-700 transition shadow-md"
                                                            >
                                                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                                                                English Preview
                                                            </button>
                                                        </div>
                                                    </div>

                                                    <div class="mt-6 pt-6 border-t border-green-200">
                                                        <h4 class="text-lg font-bold text-green-900 mb-4">ğŸ“¢ LinkedInì— í™ë³´í•˜ê¸°</h4>
                                                        <div class="flex flex-wrap gap-4">
                                                            <button 
                                                                @click="shareToLinkedin('ko')"
                                                                :disabled="sharing"
                                                                class="flex items-center px-6 py-3 bg-[#0077b5] text-white font-bold rounded-md hover:bg-[#005885] transition shadow-md disabled:opacity-50"
                                                            >
                                                                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
                                                                <span x-text="sharing === 'ko' ? 'ê²Œì‹œ ì¤‘...' : 'í•œêµ­ì–´ë¡œ í¬ìŠ¤íŒ…'"></span>
                                                            </button>
                                                            <button 
                                                                @click="shareToLinkedin('en')"
                                                                :disabled="sharing"
                                                                class="flex items-center px-6 py-3 bg-[#0077b5] text-white font-bold rounded-md hover:bg-[#005885] transition shadow-md disabled:opacity-50"
                                                            >
                                                                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
                                                                <span x-text="sharing === 'en' ? 'Posting...' : 'Post in English'"></span>
                                                            </button>
                                                        </div>
                                                        <p x-show="shareMessage" class="mt-4 text-base font-bold" :class="shareStatus === 'success' ? 'text-blue-600' : 'text-red-600'" x-text="shareMessage"></p>
                                                    </div>
                                                </div>
                                            </template>
                                            <template x-if="result?.status !== 'success'">
                                                <p x-text="result?.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'"></p>
                                            </template>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Youtube Poster Section (Placeholder) -->
            <div x-show="mainTab === 'youtube'" class="flex flex-col h-full" x-cloak>
                <!-- Header -->
                <div class="bg-red-600 p-6 text-white shadow-md">
                    <div class="container mx-auto">
                        <h2 class="text-2xl font-bold">ğŸ¬ Youtube Poster</h2>
                        <p class="text-red-100 text-sm mt-1">AI ê¸°ë°˜ ì˜ìƒ í¸ì§‘ ë° ìœ íŠœë¸Œ ì—…ë¡œë“œ ìë™í™”</p>
                    </div>
                </div>
                
                <div class="container mx-auto p-10 flex-grow overflow-y-auto">
                    <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                        <h3 class="text-xl font-bold text-gray-800 mb-6">ğŸ“¹ ìƒˆë¡œìš´ ì˜ìƒ ì—…ë¡œë“œ</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">ì¹´í…Œê³ ë¦¬ ì„ íƒ</label>
                                    <select x-model="ytCategory" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 outline-none">
                                        <option value="tech">Tech (ê¸°ìˆ )</option>
                                        <option value="entertainment">Entertainment (ì—”í„°í…Œì¸ë¨¼íŠ¸)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">ì˜ìƒ íŒŒì¼ (Source Video)</label>
                                    <div 
                                        @dragover.prevent="ytDragOver = true"
                                        @dragleave.prevent="ytDragOver = false"
                                        @drop.prevent="handleYtDrop($event)"
                                        @click="$refs.ytFileInput.click()"
                                        :class="{'border-red-500 bg-red-50': ytDragOver, 'border-gray-300 bg-white': !ytDragOver}"
                                        class="border-2 border-dashed rounded-lg p-8 text-center hover:bg-gray-50 transition-colors cursor-pointer min-h-[150px] flex flex-col justify-center items-center"
                                    >
                                        <input type="file" x-ref="ytFileInput" class="hidden" @change="handleYtFile($event)" accept="video/*">
                                        
                                        <template x-if="!ytFile">
                                            <div class="space-y-2">
                                                <svg class="mx-auto h-10 w-10 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
                                                <p class="text-sm text-gray-500 font-medium">í´ë¦­í•˜ê±°ë‚˜ ì˜ìƒì„ ë“œë˜ê·¸í•˜ì„¸ìš”</p>
                                                <p class="text-xs text-gray-400">MP4, MOV, AVI ë“± ì˜ìƒ íŒŒì¼</p>
                                            </div>
                                        </template>

                                        <template x-if="ytFile">
                                            <div class="space-y-2">
                                                <svg class="mx-auto h-10 w-10 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                                                <p class="text-sm font-bold text-gray-900" x-text="ytFile.name"></p>
                                                <p class="text-xs text-gray-500" x-text="formatBytes(ytFile.size)"></p>
                                                <button @click.stop="ytFile = null" class="text-xs text-red-600 hover:text-red-800 underline font-medium">ì œê±°</button>
                                            </div>
                                        </template>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">ì°¸ì¡° PDF íŒŒì¼ (Metadata Source)</label>
                                    <div 
                                        @dragover.prevent="pdfDragOver = true"
                                        @dragleave.prevent="pdfDragOver = false"
                                        @drop.prevent="handlePdfDrop($event)"
                                        @click="$refs.pdfFileInput.click()"
                                        :class="{'border-blue-500 bg-blue-50': pdfDragOver, 'border-gray-300 bg-white': !pdfDragOver}"
                                        class="border-2 border-dashed rounded-lg p-6 text-center hover:bg-gray-50 transition-colors cursor-pointer min-h-[120px] flex flex-col justify-center items-center"
                                    >
                                        <input type="file" x-ref="pdfFileInput" class="hidden" @change="handlePdfFile($event)" accept=".pdf">
                                        
                                        <template x-if="!pdfFile">
                                            <div class="space-y-1">
                                                <svg class="mx-auto h-8 w-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg>
                                                <p class="text-xs text-gray-500 font-medium">ì°¸ì¡°í•  PDF íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì„¸ìš”</p>
                                            </div>
                                        </template>

                                        <template x-if="pdfFile">
                                            <div class="space-y-1">
                                                <svg class="mx-auto h-8 w-8 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                                                <p class="text-xs font-bold text-gray-900" x-text="pdfFile.name"></p>
                                                <button @click.stop="pdfFile = null" class="text-xs text-red-600 hover:text-red-800 underline">ì œê±°</button>
                                            </div>
                                        </template>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="gen_sub" x-model="genSubtitles" class="h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded">
                                    <label for="gen_sub" class="ml-2 block text-sm text-gray-900">AI ìë§‰ ìë™ ìƒì„±</label>
                                </div>

                                <!-- Logo Management Area -->
                                <div class="pt-6 border-t border-gray-200">
                                    <label class="block text-sm font-bold text-gray-700 mb-4">ì±„ë„ ë¡œê³  ê´€ë¦¬ (Overlay Logo)</label>
                                    <div class="flex flex-col md:flex-row gap-6 items-start">
                                        <!-- Current Logo Preview -->
                                        <div class="w-full md:w-1/2">
                                            <p class="text-xs font-bold text-gray-500 mb-2 uppercase">í˜„ì¬ ì ìš©ëœ ë¡œê³ </p>
                                            <div class="bg-gray-100 rounded-lg p-4 border border-gray-200 flex justify-center items-center min-h-[100px]">
                                                <img :src="'/api/youtube/logo/' + ytCategory + '?token=' + localStorage.getItem('access_token') + '&t=' + logoTimestamp" class="max-h-20 object-contain shadow-sm" alt="Current Logo">
                                            </div>
                                            <div class="mt-2 text-[10px] text-gray-500 leading-relaxed">
                                                <p>ğŸ’¡ **ê¶Œì¥ ì‚¬ì–‘:** ê°€ë¡œí˜• ë¡œê³  (ë°°ê²½ íˆ¬ëª… PNG ê¶Œì¥)</p>
                                                <p>í˜„ì¬ ë¡œê³  ê¸°ì¤€: <span class="font-bold">1000x250 (4:1 ë¹„ìœ¨)</span></p>
                                            </div>
                                        </div>

                                        <!-- Logo Upload -->
                                        <div class="w-full md:w-1/2">
                                            <p class="text-xs font-bold text-gray-500 mb-2 uppercase">ë¡œê³  êµì²´</p>
                                            <div 
                                                @click="$refs.logoInput.click()"
                                                class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:bg-gray-50 transition-colors cursor-pointer flex flex-col justify-center items-center min-h-[100px]"
                                            >
                                                <input type="file" x-ref="logoInput" class="hidden" @change="validateAndUploadLogo($event)" accept="image/png">
                                                <svg class="h-6 w-6 text-gray-400 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
                                                <p class="text-xs text-gray-500">ìƒˆ ë¡œê³  ì—…ë¡œë“œ (PNG)</p>
                                            </div>
                                            <p x-show="logoError" x-text="logoError" class="mt-2 text-[10px] text-red-500 font-bold"></p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="space-y-6 bg-gray-50 p-6 rounded-lg border border-gray-200">
                                <h4 class="font-bold text-gray-700">ğŸ“œ í†µí•© ê°€ì´ë“œ</h4>
                                <ul class="text-sm text-gray-600 space-y-3 list-disc ml-4">
                                    <li><strong>ì½˜í…ì¸  ë¶„ì„:</strong> ì—…ë¡œë“œëœ PDF ìë£Œë¥¼ Gemini AIê°€ ë¶„ì„í•˜ì—¬ ìµœì ì˜ ë©”íƒ€ë°ì´í„°ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.</li>
                                    <li><strong>í”„ë¦¬ë·° í™•ì¸:</strong> ë°°í¬ ì „ AIê°€ ìƒì„±í•œ ì œëª©, ìƒì„¸ ì„¤ëª…, íƒœê·¸ë¥¼ ë¯¸ë¦¬ í™•ì¸í•˜ê³  ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                                    <li><strong>ìë™ í¸ì§‘:</strong> ì˜ìƒì— ë¡œê³ , ì•„ì›ƒíŠ¸ë¡œë¥¼ í•©ì„±í•˜ê³  ì„ íƒ ì‹œ ìë§‰ì„ ìƒì„±í•©ë‹ˆë‹¤.</li>
                                    <li><strong>ì›í´ë¦­ ì—…ë¡œë“œ:</strong> ëª¨ë“  ì¤€ë¹„ê°€ ì™„ë£Œë˜ë©´ YouTube APIë¥¼ í†µí•´ ì±„ë„ì— ì¦‰ì‹œ ê²Œì‹œë©ë‹ˆë‹¤.</li>
                                    <li><strong>ì†Œì…œ í™ë³´:</strong> ì—…ë¡œë“œ ì™„ë£Œ í›„, AI ìš”ì•½ ê¸°ìˆ ì„ í™œìš©í•´ LinkedInì— ì¦‰ì‹œ í™ë³´ ê²Œì‹œë¬¼ì„ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                                </ul>
                                <div class="pt-4 space-y-3">
                                    <button 
                                        @click="generateYoutubeMetadata()"
                                        :disabled="!pdfFile || ytLoading"
                                        :class="!pdfFile || ytLoading ? 'bg-gray-400 cursor-not-allowed' : 'bg-blue-600 hover:bg-blue-700'"
                                        class="w-full py-3 text-white font-bold rounded-lg transition shadow-md flex justify-center items-center"
                                    >
                                        <span x-show="!ytLoading">ğŸ” ë©”íƒ€ë°ì´í„° ë¯¸ë¦¬ë³´ê¸° ìƒì„±</span>
                                        <svg x-show="ytLoading" class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                                    </button>
                                    <button 
                                        @click="uploadYoutube()"
                                        :disabled="!ytFile || !ytMetadata || ytLoading"
                                        :class="!ytFile || !ytMetadata || ytLoading ? 'bg-gray-400 cursor-not-allowed' : 'bg-red-600 hover:bg-red-700'"
                                        class="w-full py-4 text-white font-bold rounded-lg transition shadow-lg flex justify-center items-center"
                                    >
                                        <span x-show="!ytLoading">ğŸ¬ ìµœì¢… í¸ì§‘ ë° ì—…ë¡œë“œ ì‹œì‘</span>
                                        <svg x-show="ytLoading" class="animate-spin h-6 w-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Youtube Result Area -->
                        <div x-show="ytResult" x-cloak class="mt-8 p-6 rounded-xl shadow-sm border" :class="ytResult?.status === 'success' ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200'">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <template x-if="ytResult?.status === 'success'">
                                        <svg class="h-8 w-8 text-green-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>
                                    </template>
                                    <template x-if="ytResult?.status !== 'success'">
                                        <svg class="h-8 w-8 text-red-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" /></svg>
                                    </template>
                                </div>
                                <div class="ml-4 flex-grow">
                                    <h3 class="text-xl font-bold" :class="ytResult?.status === 'success' ? 'text-green-800' : 'text-red-800'" x-text="ytResult?.status === 'success' ? 'ìœ íŠœë¸Œ ì—…ë¡œë“œ ì™„ë£Œ!' : 'ì˜¤ë¥˜ ë°œìƒ'"></h3>
                                    <div class="mt-3 text-lg" :class="ytResult?.status === 'success' ? 'text-green-700' : 'text-red-700'">
                                        <template x-if="ytResult?.status === 'success'">
                                            <div class="space-y-4">
                                                <p>ì˜ìƒì´ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ê³  ìœ íŠœë¸Œì— ê²Œì‹œë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                                                <div class="flex items-center gap-4">
                                                    <a :href="ytResult.link" target="_blank" class="px-6 py-2 bg-red-600 text-white rounded-md font-bold hover:bg-red-700 transition shadow-md">ğŸ¬ ì˜ìƒ í™•ì¸í•˜ê¸°</a>
                                                </div>
                                                
                                                <!-- LinkedIn ê³µìœ  ì„¹ì…˜ -->
                                                <div class="mt-6 pt-6 border-t border-green-200">
                                                    <h4 class="text-lg font-bold text-green-900 mb-4">ğŸ“¢ LinkedInì— í™ë³´í•˜ê¸°</h4>
                                                    <div class="flex flex-wrap gap-4">
                                                        <button 
                                                            @click="shareYoutubeToLinkedin('ko')"
                                                            :disabled="sharing"
                                                            class="flex items-center px-6 py-3 bg-[#0077b5] text-white font-bold rounded-md hover:bg-[#005885] transition shadow-md disabled:opacity-50"
                                                        >
                                                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
                                                            <span x-text="sharing === 'ko' ? 'ê²Œì‹œ ì¤‘...' : 'í•œêµ­ì–´ë¡œ í¬ìŠ¤íŒ…'"></span>
                                                        </button>
                                                        <button 
                                                            @click="shareYoutubeToLinkedin('en')"
                                                            :disabled="sharing"
                                                            class="flex items-center px-6 py-3 bg-[#0077b5] text-white font-bold rounded-md hover:bg-[#005885] transition shadow-md disabled:opacity-50"
                                                        >
                                                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
                                                            <span x-text="sharing === 'en' ? 'Posting...' : 'Post in English'"></span>
                                                        </button>
                                                    </div>
                                                    <p x-show="shareMessage" class="mt-4 text-base font-bold" :class="shareStatus === 'success' ? 'text-blue-600' : 'text-red-600'" x-text="shareMessage"></p>
                                                </div>
                                            </div>
                                        </template>
                                        <template x-if="ytResult?.status !== 'success'">
                                            <p x-text="ytResult?.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'"></p>
                                        </template>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Metadata Preview Area -->
                        <div x-show="ytMetadata" x-transition x-cloak class="mt-8 bg-blue-50 border border-blue-200 rounded-xl p-6 shadow-sm">
                            <div class="flex justify-between items-center mb-4">
                                <h4 class="text-lg font-bold text-blue-900 flex items-center">
                                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20"><path d="M10 12a2 2 0 100-4 2 2 0 000 4z"/><path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"/></svg>
                                    ë©”íƒ€ë°ì´í„° ë¯¸ë¦¬ë³´ê¸° (AI Generated)
                                </h4>
                                <button @click="ytMetadata = null" class="text-blue-500 hover:text-blue-700 text-sm font-medium">ë‹«ê¸°</button>
                            </div>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-xs font-bold text-blue-700 uppercase mb-1">ì˜ìƒ ì œëª©</label>
                                    <div class="bg-white border border-blue-200 rounded p-3 text-sm font-bold" x-text="ytMetadata?.title"></div>
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-blue-700 uppercase mb-1">ìƒì„¸ ì„¤ëª…</label>
                                    <div class="bg-white border border-blue-200 rounded p-3 text-sm whitespace-pre-wrap leading-relaxed h-48 overflow-y-auto" x-text="ytMetadata?.description"></div>
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-blue-700 uppercase mb-1">íƒœê·¸</label>
                                    <div class="flex flex-wrap gap-2">
                                        <template x-for="tag in ytMetadata?.tags" :key="tag">
                                            <span class="bg-blue-100 text-blue-700 px-2 py-1 rounded text-xs font-medium" x-text="'#' + tag"></span>
                                        </template>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function app() {
            return {
                mainTab: 'wiki', // 'wiki' or 'youtube'
                tab: 'file',
                dragOver: false,
                file: null,
                title: '',
                content: '',
                loading: false,
                result: null,
                sharing: null,
                shareStatus: null,
                shareMessage: '',

                // User State
                user: null,

                // Youtube Poster State
                ytFile: null,
                ytDragOver: false,
                pdfFile: null,
                pdfDragOver: false,
                ytCategory: 'tech',
                genSubtitles: false,
                ytLoading: false,
                ytMetadata: null,
                ytResult: null,
                logoTimestamp: Date.now(),
                logoError: '',

                async init() {
                    const token = localStorage.getItem('access_token');
                    if (!token) {
                        window.location.href = '/login';
                        return;
                    }
                    
                    try {
                        const response = await fetch('/api/auth/me', {
                            headers: { 'Authorization': `Bearer ${token}` }
                        });
                        if (response.ok) {
                            this.user = await response.json();
                        } else {
                            localStorage.removeItem('access_token');
                            window.location.href = '/login';
                        }
                    } catch (error) {
                        console.error('Failed to fetch user:', error);
                    }
                },

                logout() {
                    localStorage.removeItem('access_token');
                    window.location.href = '/login';
                },

                handleDrop(e) {
                    this.dragOver = false;
                    const files = e.dataTransfer.files;
                    if (files.length > 0 && files[0].name.endsWith('.md')) {
                        this.file = files[0];
                    } else {
                        alert('MD íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                    }
                },

                handleFile(e) {
                    const files = e.target.files;
                    if (files.length > 0) {
                        this.file = files[0];
                    }
                },

                handleYtDrop(e) {
                    this.ytDragOver = false;
                    const files = e.dataTransfer.files;
                    if (files.length > 0 && files[0].type.startsWith('video/')) {
                        this.ytFile = files[0];
                    } else {
                        alert('ì˜ìƒ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                    }
                },

                handleYtFile(e) {
                    const files = e.target.files;
                    if (files.length > 0) {
                        this.ytFile = files[0];
                    }
                },

                handlePdfDrop(e) {
                    this.pdfDragOver = false;
                    const files = e.dataTransfer.files;
                    if (files.length > 0 && files[0].name.endsWith('.pdf')) {
                        this.pdfFile = files[0];
                    } else {
                        alert('PDF íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                    }
                },

                handlePdfFile(e) {
                    const files = e.target.files;
                    if (files.length > 0) {
                        this.pdfFile = files[0];
                    }
                },

                async generateYoutubeMetadata() {
                    if (!this.pdfFile) return;
                    
                    this.ytLoading = true;
                    const formData = new FormData();
                    formData.append('pdf', this.pdfFile);
                    formData.append('category', this.ytCategory);

                    try {
                        const response = await fetch('/api/youtube/metadata', {
                            method: 'POST',
                            headers: { 'Authorization': `Bearer ${localStorage.getItem('access_token')}` },
                            body: formData
                        });
                        const data = await response.json();
                        if (data.status === 'success') {
                            this.ytMetadata = data.metadata;
                        } else {
                            alert('ë©”íƒ€ë°ì´í„° ìƒì„± ì‹¤íŒ¨: ' + data.message);
                        }
                    } catch (error) {
                        alert('ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
                    } finally {
                        this.ytLoading = false;
                    }
                },

                validateAndUploadLogo(e) {
                    const file = e.target.files[0];
                    if (!file) return;

                    this.logoError = '';
                    
                    // 1. íŒŒì¼ í˜•ì‹ ê²€ì¦
                    if (file.type !== 'image/png') {
                        this.logoError = 'âŒ ë¡œê³ ëŠ” ë°°ê²½ì´ íˆ¬ëª…í•œ PNG íŒŒì¼ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.';
                        return;
                    }

                    const img = new Image();
                    img.onload = async () => {
                        const ratio = img.width / img.height;
                        
                        // 2. ì‚¬ì´ì¦ˆ ë° ë¹„ìœ¨ ê²€ì¦ (ê°€ì´ë“œ ê¸°ì¤€: 1000x250, 4:1)
                        // ëŒ€ëµì ì¸ ë¹„ìœ¨ í—ˆìš© ì˜¤ì°¨ 10%
                        if (ratio < 2.5 || ratio > 5.5) {
                            this.logoError = `âš ï¸ ë¹„ìœ¨ì´ ì ì ˆí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤ (í˜„ì¬ ${ratio.toFixed(1)}:1). 4:1ì— ê°€ê¹Œìš´ ê°€ë¡œí˜• ë¡œê³ ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤.`;
                            // ê²½ê³ ë§Œ í•˜ê³  ì§„í–‰í•  ìˆ˜ ìˆê²Œ í•˜ê±°ë‚˜, ì•„ì˜ˆ ë§‰ìœ¼ë ¤ë©´ ì—¬ê¸°ì„œ return
                        }

                        if (img.width < 400) {
                            this.logoError = 'âŒ ë¡œê³  ê°€ë¡œ í•´ìƒë„ê°€ ë„ˆë¬´ ë‚®ìŠµë‹ˆë‹¤. (ìµœì†Œ 400px ì´ìƒ ê¶Œì¥)';
                            return;
                        }

                        // 3. ì—…ë¡œë“œ ì§„í–‰
                        const formData = new FormData();
                        formData.append('logo', file);
                        formData.append('category', this.ytCategory);

                        try {
                        const response = await fetch('/api/youtube/logo/upload', {
                            method: 'POST',
                            headers: { 'Authorization': `Bearer ${localStorage.getItem('access_token')}` },
                            body: formData
                        });
                            const data = await response.json();
                            if (data.status === 'success') {
                                this.logoTimestamp = Date.now();
                                alert('âœ… ë¡œê³ ê°€ ì„±ê³µì ìœ¼ë¡œ êµì²´ë˜ì—ˆìŠµë‹ˆë‹¤.');
                            } else {
                                this.logoError = 'âŒ ì—…ë¡œë“œ ì‹¤íŒ¨: ' + data.message;
                            }
                        } catch (err) {
                            this.logoError = 'âŒ ì„œë²„ ì˜¤ë¥˜ ë°œìƒ';
                        }
                    };
                    img.src = URL.createObjectURL(file);
                },

                formatBytes(bytes, decimals = 2) {
                    if (bytes === 0) return '0 Bytes';
                    const k = 1024;
                    const dm = decimals < 0 ? 0 : decimals;
                    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                    const i = Math.floor(Math.log(bytes) / Math.log(k));
                    return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
                },

                async upload() {
                    this.loading = true;
                    this.result = null;
                    const formData = new FormData();

                    if (this.tab === 'file') {
                        formData.append('file', this.file);
                    } else {
                        formData.append('title', this.title);
                        formData.append('content', this.content);
                    }

                    try {
                        const response = await fetch('/api/upload', {
                            method: 'POST',
                            headers: { 'Authorization': `Bearer ${localStorage.getItem('access_token')}` },
                            body: formData
                        });
                        this.result = await response.json();
                    } catch (error) {
                        this.result = { status: 'error', message: error.message };
                    } finally {
                        this.loading = false;
                    }
                },

                previewHtml(lang) {
                    if (!this.result || !this.result.preview_html_ko) {
                        alert('ë³€í™˜ëœ HTMLì´ ì—†ìŠµë‹ˆë‹¤.');
                        return;
                    }
                    
                    const htmlContent = lang === 'ko' ? this.result.preview_html_ko : this.result.preview_html_en;
                    const previewWindow = window.open('', '_blank', 'width=1200,height=800');
                    previewWindow.document.write(htmlContent);
                    previewWindow.document.close();
                },

                async shareToLinkedin(lang) {
                    this.sharing = lang;
                    this.shareStatus = null;
                    this.shareMessage = '';

                    const formData = new FormData();
                    formData.append('wiki_id', this.result.wiki_id);
                    formData.append('wiki_url', this.result.link);
                    formData.append('lang', lang);

                    try {
                        const response = await fetch('/api/share/linkedin', {
                            method: 'POST',
                            headers: { 'Authorization': `Bearer ${localStorage.getItem('access_token')}` },
                            body: formData
                        });
                        const data = await response.json();
                        this.shareStatus = data.status;
                        this.shareMessage = data.message;
                    } catch (error) {
                        this.shareStatus = 'error';
                        this.shareMessage = 'ê³µìœ  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message;
                    } finally {
                        this.sharing = null;
                    }
                },

                async uploadYoutube() {
                    if (!this.ytFile || !this.pdfFile) {
                        alert('ì˜ìƒê³¼ PDF íŒŒì¼ì„ ëª¨ë‘ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.');
                        return;
                    }

                    this.ytLoading = true;
                    this.ytResult = null;
                    const formData = new FormData();
                    formData.append('video', this.ytFile);
                    formData.append('pdf', this.pdfFile);
                    formData.append('category', this.ytCategory);
                    formData.append('gen_sub', this.genSubtitles);

                    try {
                        const response = await fetch('/api/youtube/upload', {
                            method: 'POST',
                            headers: { 'Authorization': `Bearer ${localStorage.getItem('access_token')}` },
                            body: formData
                        });
                        this.ytResult = await response.json();
                    } catch (error) {
                        this.ytResult = { status: 'error', message: error.message };
                    } finally {
                        this.ytLoading = false;
                    }
                },

                async shareYoutubeToLinkedin(lang) {
                    this.sharing = lang;
                    this.shareStatus = null;
                    this.shareMessage = '';

                    const formData = new FormData();
                    formData.append('video_id', this.ytResult.video_id);
                    formData.append('video_url', this.ytResult.link);
                    formData.append('lang', lang);

                    try {
                        const response = await fetch('/api/youtube/share/linkedin', {
                            method: 'POST',
                            headers: { 'Authorization': `Bearer ${localStorage.getItem('access_token')}` },
                            body: formData
                        });
                        const data = await response.json();
                        this.shareStatus = data.status;
                        this.shareMessage = data.message;
                    } catch (error) {
                        this.shareStatus = 'error';
                        this.shareMessage = 'ê³µìœ  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message;
                    } finally {
                        this.sharing = null;
                    }
                }
            }
        }
    </script>
</body>
</html>

